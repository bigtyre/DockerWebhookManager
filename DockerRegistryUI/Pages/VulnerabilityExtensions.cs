using TrivyAPIClient;

namespace DockerRegistryUI.Pages
{
    public static class VulnerabilityExtensions
    {
        public static IOrderedEnumerable<Vulnerability> SortBySeverity(this IEnumerable<Vulnerability> vulnerabilities)
        {
            return vulnerabilities
                .OrderBy(c => !string.Equals(c.Severity, "Critical", StringComparison.OrdinalIgnoreCase))
                .ThenBy(c => !string.Equals(c.Severity, "High", StringComparison.OrdinalIgnoreCase))
                .ThenBy(c => !string.Equals(c.Severity, "Medium", StringComparison.OrdinalIgnoreCase))
                .ThenBy(c => !string.Equals(c.Severity, "Low", StringComparison.OrdinalIgnoreCase))
                .ThenBy(c => !string.Equals(c.Severity, "Unknown", StringComparison.OrdinalIgnoreCase));
        }
    }
}
